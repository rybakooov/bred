<template>
  <section :class="$style.container" id="reviews">
    <div :class="$style.header">
      <p :class="$style.title" data-aos="fade-up"><span :class="$style.text">–û—Ç–∑—ã–≤—ã —É—á–µ–Ω–∏–∫–æ–≤</span></p>
      <div :class="$style.controls" data-aos="zoom-in">
        <icon-arrow-control :class="$style.controls_left" @click.native="prev" />
        <icon-arrow-control :class="$style.controls_right" @click.native="next" />
      </div>
    </div>
    <swiper ref="mySwiper" :options="swiperOption" :class="[$style.line, {[$style.open]: opened}]">
      <swiper-slide v-for="(review, i) in reviews" :key="i + '_review'" :class="$style.slide">
        <div :class="$style.review" data-aos="fade-in" :data-aos-delay="200 * i">
          <div :class="$style.top">
            <div :class="$style.avatar" v-if="review.avatar"><img :src="review.avatar"></div>
            <div>
              <p :class="$style.name"><span :class="$style.text">{{ review.name }}</span></p>
              <p :class="$style.student"><span :class="$style.text">{{ review.student }}</span></p>
            </div>
          </div>
          <p :class="$style.description"><span :class="$style.text" v-html="review.desc" /></p>
          <div :class="$style.button">
            <span :class="$style.text">–û—Ä–∏–≥–∏–Ω–∞–ª –æ—Ç–∑—ã–≤–∞</span>
            <icon-arrow-control :class="$style.icon" fill="#E47138" color="#F4F4F4" />
            <ui-button :class="$style.absolute" @click.native="$refs.popup.openPopup(review.src)"/>
          </div>
        </div>
      </swiper-slide>
    </swiper>
    <ui-button :class="$style.more" @click.native="opened = true" v-if="!opened">
      <span :class="$style.moreContent">
        <icon-plus :class="$style.icon" />
        <span :class="$style.text">–ü–æ–∫–∞–∑–∞—Ç—å –µ—â—ë</span>
      </span>
    </ui-button>
    <popup-review ref="popup" />
  </section>
</template>

<script>
import IconArrowControl from '~/components/icons/arrow-control'
import UiButton from '~/components/ui/button'
import IconPlus from '~/components/icons/plus'
import PopupReview from '~/components/popups/review'
export default {
  name: 'MainReviews',
  components: {
    PopupReview,
    IconPlus,
    UiButton,
    IconArrowControl
  },
  data () {
    return {
      opened: false,
      swiperOption: {
        slidesPerView: 'auto',
        spaceBetween: 16
      },
      reviews: [
        {
          name: "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä",
          student: "–°—Ç—É–¥–µ–Ω—Ç –∫—É—Ä—Å–∞, 2021 –≥–æ–¥",
          desc: "–ê–Ω—Ç–æ–Ω, –ø—Ä–∏–≤–µ—Ç. –ü–æ–ª—å–∑—É—é—Å—å —Ç–≤–æ–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π –∏ –æ–Ω–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç –ø—Ä–∏–Ω–æ—Å–∏—Ç—å —Ö–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —Å–ø–∞—Å–∏–±–æ —Ç–µ–±–µ –æ–≥—Ä–æ–º–Ω–æ–µ! <br><br>–í—Å–µ–≥–æ –∑–∞ 1 –¥–µ–Ω—å 14%üî•",
          src: require('~/assets/images/reviews/original-1.jpg'),
          avatar: require('~/assets/images/reviews/avatar-1.jpg')
        },
        {
          name: "sma",
          student: "–°—Ç—É–¥–µ–Ω—Ç –∫—É—Ä—Å–∞, 2021 –≥–æ–¥",
          desc: "–°–µ–≥–æ–¥–Ω—è –ø–µ—Ä–µ–±–æ—Ä–æ–ª —Å—Ç—Ä–∞—Ö –∏ –≤–æ—à—ë–ª –≤ —Å–¥–µ–ª–∫—É –Ω–∞ 3–∫$, –Ω–∞ –æ–¥–Ω–æ–π —Å–¥–µ–ª–∫–µ –æ—Ç–±–∏–ª –≤–µ—Å—å –∫—É—Ä—Åü§≠üòÜ‚òù <br><br>–ê–Ω—Ç–æ–Ω, —Å–ø–∞—Å–∏–±–æ –∑–∞ —Ç–æ, —á—Ç–æ –≤—Å–µ–ª–∏–ª —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ –≤–ª–æ–∂–∏–ª –∑–Ω–∞–Ω–∏—èüôè",
          src: require('~/assets/images/reviews/original-2.jpg')
        },
        {
          name: "–í–∞–Ω—è –ß–∏—Å—Ç—è–∫–æ–≤",
          student: "–°—Ç—É–¥–µ–Ω—Ç –∫—É—Ä—Å–∞, 2021 –≥–æ–¥",
          desc: "–ü–æ—Å–ª–µ –∫—É—Ä—Å–∞ —Ä–µ—à–∏–ª –Ω–µ–º–Ω–æ–≥–æ –ø–æ—Ç–æ—Ä–≥–æ–≤–∞—Ç—å –≤ –∞–≤–≥—É—Å—Ç–µ, –≤—ã—à–ª–æ –∫–∞–∫-—Ç–æ —Ç–∞–∫ - 38% –ø—Ä–∏–±—ã–ª–∏ –∑–∞ –º–µ—Å—è—Ü",
          src: require('~/assets/images/reviews/original-3.jpg'),
          avatar: require('~/assets/images/reviews/avatar-3.jpg')
        },
        {
          name: "Light_of_Orion",
          student: "–°—Ç—É–¥–µ–Ω—Ç –∫—É—Ä—Å–∞, 2020 –≥–æ–¥",
          desc: "–ê–Ω—Ç–æ–Ω, –ø—Ä–∏–≤–µ—Ç. –ù–∞–∫–æ–Ω–µ—Ü —Ç–æ –¥–æ–ø—Ä–æ—à–µ–ª –≤–∏–¥–µ–æ—Ñ–æ—Ä–º–∞—Ç –∫—É—Ä—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–∫–æ–Ω–µ—Ü-—Ç–æ –≤—Å—ë —Ä–∞—Å—Å—Ç–∞–≤–∏–ª –ø–æ –ø–æ–ª–æ—á–∫–∞–º, —Å–µ–π—á–∞—Å –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é —Å–≤—è–∑–∫—É –∫–æ—Ç–æ—Ä—É—é —Ç—ã —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–ª. –ó–∞ —Å–µ–≥–æ–¥–Ω—è —É–∂–µ –ø–ª—é—Å–Ω—É–ª –±–ª–∞–≥–æ–¥–∞—Ä—è –µ–π +5% –∫ –¥–µ–ø–æ, –∞ –∑–∞ –∏—é–ª—å +63% –∫ –æ–±—â–µ–º—É –¥–µ–ø–æ!",
          src: require('~/assets/images/reviews/original-4.jpg'),
          avatar: require('~/assets/images/reviews/avatar-4.jpg')
        },
        {
          name: "–ó–∞—Ö–∞—Ä–æ–≤ –ú–∏—Ö–∞–∏–ª",
          student: "–°—Ç—É–¥–µ–Ω—Ç –∫—É—Ä—Å–∞, 2020 –≥–æ–¥",
          desc: "–ü–µ—Ä–≤—ã–π –¥–µ–Ω—å –Ω–∞ –±–∏—Ä–∂–µ –ø—Ä–æ–≤–µ–ª –ø–æ —É—Ä–æ–∫–∞–º<br>+15% –æ—Ç –¥–µ–ø–æ–∑–∏—Ç–∞ –∑–∞ –¥–µ–Ω—å<br>–°–ø–∞—Å–∏–±–æ <br>–î–∞–ª—å—à–µ –±–æ–ª—å—à–µüí™",
          src: require('~/assets/images/reviews/original-5.jpg'),
          avatar: require('~/assets/images/reviews/avatar-5.jpg')
        }
      ]
    }
  },
  computed: {
    swiper() {
      return this.$refs.mySwiper.$swiper
    }
  },
  methods: {
    next() {
      this.swiper.slideNext()
    },
    prev() {
      this.swiper.slidePrev()
    }
  },
  mounted() {
    if (document.documentElement.offsetWidth < 768) {
      this.swiper.destroy(true, true)
    }
  }
}
</script>

<style lang="scss" module>
  .container {
    padding: 0 var(--root-layout-offset);
    overflow: hidden;
  }
  .header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 3.2em;
    @include down(xxl) {
      margin-bottom: 2.4em;
    }
  }
  .title {
    font-weight: 500;
    .text {
      font-size: 3em;
      line-height: 1.07;
      letter-spacing: -0.03em;
      color: #272727;
    }
  }
  .controls {
    @include down(md) {
      display: none;
    }
    &_left {
      width: 2.4em;
      height: 2.4em;
      cursor: pointer;
    }
    &_right {
      transform: rotate(180deg);
      margin-left: .8em;
      width: 2.4em;
      height: 2.4em;
      cursor: pointer;
    }
  }
  .line {
    display: flex;
    flex-wrap: nowrap;
    margin: 0 calc(-1 * var(--root-layout-offset));
    padding: 0 var(--root-layout-offset);
    @include down(md) {
      flex-direction: column;
      margin: 0;
      padding: 0;
      :global(.swiper-wrapper) {
        display: grid;
      }
    }
  }
  .slide {
    width: 54.4em;
    height: 33em;
    @include down(md) {
      width: 100% !important;
      height: auto;
      &:not(:last-child) {
        margin-bottom: 1.6em;
      }
      &:nth-child(n + 4) {
        display: none;
      }
    }
  }
  .open {
    @include down(md) {
      .slide {
        display: block !important;
      }
    }
  }

  .review {
    padding: 3.2em;
    border-radius: 2.5em;
    background: #F4F4F4;
    @include down(md) {
      box-sizing: border-box;
      width: 100% !important;
      height: auto;
    }
  }
  .top {
    display: flex;
  }
  .avatar {
    margin-right: 1.6em;
    width: 5em;
    height: 5em;
    border-radius: 50%;
    overflow: hidden;
    img {
      width: 100%;
      height: 100%;
      display: block;
      object-fit: cover;
      object-position: center;
    }
  }
  .name {
    color: #000000;
    font-weight: 500;
    margin-bottom: .8em;
    .text {
      font-size: 2em;
      line-height: 1.2;
      letter-spacing: -0.03em;
    }
  }
  .student {
    color: #525252;
    .text {
      font-size: 1.6em;
      line-height: 1.12;
      letter-spacing: -0.01em;
    }
  }
  .description {
    color: #525252;
    font-weight: 450;
    margin-top: 2.4em;
    .text {
      font-size: 1.6em;
      line-height: 1.5;
      letter-spacing: -0.01em;
    }
  }
  .button {
    margin-top: 2.4em;
    color: #000000;
    font-weight: 500;
    display: flex;
    align-items: center;
    position: relative;
    .icon {
      width: 2.4em;
      height: 2.4em;
      transform: rotate(180deg);
      margin-left: .8em;
    }
    .text {
      font-size: 1.6em;
      line-height: 1.12;
      letter-spacing: -0.01em;
    }
    .absolute {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  }
  .more {
    display: none;
    @include down(md) {
      display: block;
      margin: 0 auto;
    }
    &Content {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-top: 2.4em;
    }
    .icon {
      margin-right: .8em;
      width: 2.4em;
      height: 2.4em;
    }
    .text {
      font-weight: 450;
      font-size: 1.6em;
      line-height: 1.12;
      letter-spacing: -0.01em;
      color: #505050;
    }
  }
</style>
